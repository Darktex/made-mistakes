(function(a,b,c){b.fn.touchwipe=function(a){var c={min_move_x:20,min_move_y:20,wipeLeft:function(){},wipeRight:function(){},wipeUp:function(){},wipeDown:function(){},preventDefaultEvents:true};if(a)b.extend(c,a);this.each(function(){function e(){this.removeEventListener("touchmove",f);a=null;d=false}function f(f){if(c.preventDefaultEvents){f.preventDefault()}if(d){var g=f.touches[0].pageX;var h=f.touches[0].pageY;var i=a-g;var j=b-h;if(Math.abs(i)>=c.min_move_x){e();if(i>0){c.wipeLeft()}else{c.wipeRight()}}else if(Math.abs(j)>=c.min_move_y){e();if(j>0){c.wipeDown()}else{c.wipeUp()}}}}function g(c){if(c.touches.length==1){a=c.touches[0].pageX;b=c.touches[0].pageY;d=true;this.addEventListener("touchmove",f,false)}}var a;var b;var d=false;if("ontouchstart"in document.documentElement){this.addEventListener("touchstart",g,false)}});return this};b.elastislide=function(a,c){this.$el=b(c);this._init(a)};b.elastislide.defaults={speed:450,easing:"",imageW:190,margin:3,border:2,minItems:1,current:0,onClick:function(){return false}};b.elastislide.prototype={_init:function(a){this.options=b.extend(true,{},b.elastislide.defaults,a);this.$slider=this.$el.find("ul");this.$items=this.$slider.children("li");this.itemsCount=this.$items.length;this.$esCarousel=this.$slider.parent();this._validateOptions();this._configure();this._addControls();this._initEvents();this.$slider.show();this._slideToCurrent(false)},_validateOptions:function(){if(this.options.speed<0)this.options.speed=450;if(this.options.margin<0)this.options.margin=4;if(this.options.border<0)this.options.border=1;if(this.options.minItems<1||this.options.minItems>this.itemsCount)this.options.minItems=1;if(this.options.current>this.itemsCount-1)this.options.current=0},_configure:function(){this.current=this.options.current;this.visibleWidth=this.$esCarousel.width();if(this.visibleWidth<this.options.minItems*(this.options.imageW+2*this.options.border)+(this.options.minItems-1)*this.options.margin){this._setDim((this.visibleWidth-(this.options.minItems-1)*this.options.margin)/this.options.minItems);this._setCurrentValues();this.fitCount=this.options.minItems}else{this._setDim();this._setCurrentValues()}this.$slider.css({width:this.sliderW})},_setDim:function(a){this.$items.css({marginRight:this.options.margin,width:a?a:this.options.imageW+2*this.options.border}).children("a").css({borderWidth:this.options.border})},_setCurrentValues:function(){this.itemW=this.$items.outerWidth(true);this.sliderW=this.itemW*this.itemsCount;this.visibleWidth=this.$esCarousel.width();this.fitCount=Math.floor(this.visibleWidth/this.itemW)},_addControls:function(){this.$navNext=b('<span class="es-nav-next">Next</span>');this.$navPrev=b('<span class="es-nav-prev">Previous</span>');b('<div class="es-nav"/>').append(this.$navPrev).append(this.$navNext).appendTo(this.$el)},_toggleControls:function(a,b){if(a&&b){if(b===1)a==="right"?this.$navNext.show():this.$navPrev.show();else a==="right"?this.$navNext.hide():this.$navPrev.hide()}else if(this.current===this.itemsCount-1||this.fitCount>=this.itemsCount)this.$navNext.hide()},_initEvents:function(){var c=this;b(a).bind("resize.elastislide",function(a){c._setCurrentValues();if(c.visibleWidth<c.options.minItems*(c.options.imageW+2*c.options.border)+(c.options.minItems-1)*c.options.margin){c._setDim((c.visibleWidth-(c.options.minItems-1)*c.options.margin)/c.options.minItems);c._setCurrentValues();c.fitCount=c.options.minItems}else{c._setDim();c._setCurrentValues()}c.$slider.css({width:c.sliderW+10});clearTimeout(c.resetTimeout);c.resetTimeout=setTimeout(function(){c._slideToCurrent()},200)});this.$navNext.bind("click.elastislide",function(a){c._slide("right")});this.$navPrev.bind("click.elastislide",function(a){c._slide("left")});this.$items.bind("click.elastislide",function(a){return c.options.onClick(b(this))});c.$slider.touchwipe({wipeLeft:function(){c._slide("right")},wipeRight:function(){c._slide("left")}})},_slide:function(a,d,e,f){if(this.$slider.is(":animated"))return false;var g=parseFloat(this.$slider.css("margin-left"));if(d===c){var h=this.fitCount*this.itemW,d;if(h<0)return false;if(a==="right"&&this.sliderW-(Math.abs(g)+h)<this.visibleWidth){h=this.sliderW-(Math.abs(g)+this.visibleWidth)-this.options.margin;this._toggleControls("right",-1);this._toggleControls("left",1)}else if(a==="left"&&Math.abs(g)-h<0){h=Math.abs(g);this._toggleControls("left",-1);this._toggleControls("right",1)}else{var i;a==="right"?i=Math.abs(g)+this.options.margin+Math.abs(h):i=Math.abs(g)-this.options.margin-Math.abs(h);if(i>0)this._toggleControls("left",1);else this._toggleControls("left",-1);if(i<this.sliderW-this.visibleWidth)this._toggleControls("right",1);else this._toggleControls("right",-1)}a==="right"?d="-="+h:d="+="+h}else{var i=Math.abs(d);if(Math.max(this.sliderW,this.visibleWidth)-i<this.visibleWidth){d=-(Math.max(this.sliderW,this.visibleWidth)-this.visibleWidth);if(d!==0)d+=this.options.margin;this._toggleControls("right",-1);i=Math.abs(d)}if(i>0)this._toggleControls("left",1);else this._toggleControls("left",-1);if(Math.max(this.sliderW,this.visibleWidth)-this.visibleWidth>i+this.options.margin)this._toggleControls("right",1);else this._toggleControls("right",-1)}b.fn.applyStyle=e===c?b.fn.animate:b.fn.css;var j={marginLeft:d};var k=this;this.$slider.applyStyle(j,b.extend(true,[],{duration:this.options.speed,easing:this.options.easing,complete:function(){if(f)f.call()}}))},_slideToCurrent:function(a){var b=this.current*this.itemW;this._slide("",-b,a)},add:function(a,b){this.$items=this.$items.add(a);this.itemsCount=this.$items.length;this._setDim();this._setCurrentValues();this.$slider.css({width:this.sliderW});this._slideToCurrent();if(b)b.call(a)},destroy:function(a){this._destroy(a)},_destroy:function(c){this.$el.unbind(".elastislide").removeData("elastislide");b(a).unbind(".elastislide");if(c)c.call()}};var d=function(a){if(this.console){console.error(a)}};b.fn.elastislide=function(a){if(typeof a==="string"){var c=Array.prototype.slice.call(arguments,1);this.each(function(){var e=b.data(this,"elastislide");if(!e){d("cannot call methods on elastislide prior to initialization; "+"attempted to call method '"+a+"'");return}if(!b.isFunction(e[a])||a.charAt(0)==="_"){d("no such method '"+a+"' for elastislide instance");return}e[a].apply(e,c)})}else{this.each(function(){var c=b.data(this,"elastislide");if(!c){b.data(this,"elastislide",new b.elastislide(a,this))}})}return this}})(window,jQuery)